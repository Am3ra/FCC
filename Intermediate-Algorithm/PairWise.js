//this is the pairwise function.
Final form
